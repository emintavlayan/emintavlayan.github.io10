
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const state = initializeState();
      document.querySelectorAll('.newcheckbox').forEach(checkbox => {
        checkbox.addEventListener('change', handleCheckboxChange);
      });
      applyFilters();

      function initializeState() {
        const initialState = {};
        document.querySelectorAll('.newcheckbox').forEach(checkbox => {
          const group = checkbox.getAttribute('data-group');
          if (!initialState[group]) {
            initialState[group] = new Set();
          }
        });
        return initialState;
      }

      function handleCheckboxChange(event) {
        const group = event.target.getAttribute('data-group');
        const value = event.target.value;
        const checked = event.target.checked;
        console.log(`Checkbox changed: Group=${group}, Value=${value}, Checked=${checked}`);
        updateState(group, value, checked);
        applyFilters();
      }

      function updateState(group, value, checked) {
        if (checked) {
          state[group].add(value);
        } else {
          state[group].delete(value);
        }
        console.log('Updated state:', state);
      }

      function applyFilters() {
        const items = Array.from(document.querySelector('.wrapper section').children);
        console.log('Applying filters to items:', items);
        items.forEach(item => {
          const shouldShow = shouldItemBeVisible(item);
          console.log(`Item ${item.outerHTML} should be ${shouldShow ? 'visible' : 'hidden'}`);
          updateItemVisibility(item, shouldShow);
        });
      }

      function shouldItemBeVisible(item) {
        return Object.keys(state).every(group => {
          const groupSet = state[group];
          console.log(`Checking group: ${group}, state: ${Array.from(groupSet)}`);
          if (groupSet.size === 0) return true;
          const groupClasses = Array.from(document.querySelectorAll(`.newcheckbox[data-group="${group}"]`))
            .map(checkbox => checkbox.value);
          const itemHasGroupClass = groupClasses.some(cls => item.classList.contains(cls));
          console.log(`Item ${item.outerHTML} has group class for ${group}: ${itemHasGroupClass}`);
          if (!itemHasGroupClass) return true;
          const itemMatchesSelected = Array.from(groupSet).some(cls => item.classList.contains(cls));
          console.log(`Item ${item.outerHTML} matches selected value in ${group}: ${itemMatchesSelected}`);
          return itemMatchesSelected;
        });
      }

      function updateItemVisibility(item, shouldShow) {
        if (shouldShow) {
          item.classList.remove('hidden');
        } else {
          item.classList.add('hidden');
        }
      }

      const navUls = document.querySelectorAll('.wrapper nav > ul');
      navUls.forEach(ul => {
        ul.style.paddingLeft = '0';
      });
    });
  </script>

